

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to chempy’s documentation! &mdash; chempy 0.6.14 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="chempy 0.6.14 documentation" href="#"/>
        <link rel="next" title="chempy package" href="chempy.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#" class="icon icon-home"> chempy
          

          
          </a>

          
            
            
              <div class="version">
                0.6.14
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="chempy.html">chempy package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">chempy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to chempy’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-chempy-s-documentation">
<h1><a class="toc-backref" href="#id3">Welcome to chempy’s documentation!</a><a class="headerlink" href="#welcome-to-chempy-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="chempy.html">chempy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="chempy.electrochemistry.html">chempy.electrochemistry package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="chempy.electrochemistry.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.electrochemistry.html#module-chempy.electrochemistry.nernst">chempy.electrochemistry.nernst module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="chempy.kinetics.html">chempy.kinetics package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="chempy.kinetics.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.analysis">chempy.kinetics.analysis module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.arrhenius">chempy.kinetics.arrhenius module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.eyring">chempy.kinetics.eyring module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.integrated">chempy.kinetics.integrated module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.ode">chempy.kinetics.ode module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.rates">chempy.kinetics.rates module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="chempy.printing.html">chempy.printing package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.js">chempy.printing.js module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.numbers">chempy.printing.numbers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.pretty">chempy.printing.pretty module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.printer">chempy.printing.printer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.string">chempy.printing.string module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.table">chempy.printing.table module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.tables">chempy.printing.tables module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.tex">chempy.printing.tex module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.web">chempy.printing.web module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="chempy.properties.html">chempy.properties package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="chempy.properties.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.debye_huckel_radii">chempy.properties.debye_huckel_radii module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.sulfuric_acid_density_myhre_1998">chempy.properties.sulfuric_acid_density_myhre_1998 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_density_tanaka_2001">chempy.properties.water_density_tanaka_2001 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_diffusivity_holz_2000">chempy.properties.water_diffusivity_holz_2000 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_permittivity_bradley_pitzer_1979">chempy.properties.water_permittivity_bradley_pitzer_1979 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_viscosity_korson_1969">chempy.properties.water_viscosity_korson_1969 module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="chempy.thermodynamics.html">chempy.thermodynamics package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="chempy.thermodynamics.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.thermodynamics.html#module-chempy.thermodynamics.expressions">chempy.thermodynamics.expressions module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="chempy.util.html">chempy.util package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.arithmeticdict">chempy.util.arithmeticdict module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.bkh">chempy.util.bkh module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.deprecation">chempy.util.deprecation module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.graph">chempy.util.graph module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.numutil">chempy.util.numutil module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.parsing">chempy.util.parsing module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.periodic">chempy.util.periodic module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.pyutil">chempy.util.pyutil module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.regression">chempy.util.regression module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.stoich">chempy.util.stoich module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.table">chempy.util.table module</a></li>
<li class="toctree-l4"><a class="reference internal" href="chempy.util.html#module-chempy.util.testing">chempy.util.testing module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.arrhenius">chempy.arrhenius module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.chemistry">chempy.chemistry module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.debye_huckel">chempy.debye_huckel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.einstein_smoluchowski">chempy.einstein_smoluchowski module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.electrolytes">chempy.electrolytes module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.equilibria">chempy.equilibria module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.eyring">chempy.eyring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.henry">chempy.henry module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.reactionsystem">chempy.reactionsystem module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.symbolic">chempy.symbolic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.html#module-chempy.units">chempy.units module</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1><a class="toc-backref" href="#id4">Indices and tables</a><a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id5">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="http://hera.physchem.kth.se:9090/bjodah/chempy"><img alt="Build status" src="http://hera.physchem.kth.se:9090/api/badges/bjodah/chempy/status.svg" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/chempy"><img alt="PyPI version" src="https://img.shields.io/pypi/v/chempy.svg" /></a>
<a class="reference external image-reference" href="https://www.python.org/"><img alt="Python version" src="https://img.shields.io/badge/python-2.7,3.5,3.6,3.7-blue.svg" /></a>
<a class="reference external image-reference" href="https://github.com/bjodah/chempy/blob/master/LICENSE"><img alt="License" src="https://img.shields.io/pypi/l/chempy.svg" /></a>
<a class="reference external image-reference" href="http://hera.physchem.kth.se/~chempy/benchmarks"><img alt="airspeedvelocity" src="http://img.shields.io/badge/benchmarked%20by-asv-green.svg?style=flat" /></a>
<a class="reference external image-reference" href="http://hera.physchem.kth.se/~chempy/branches/master/htmlcov"><img alt="coverage" src="http://hera.physchem.kth.se/~chempy/branches/master/htmlcov/coverage.svg" /></a>
<a class="reference external image-reference" href="https://doi.org/10.21105/joss.00565"><img alt="Journal of Open Source Software DOI" src="http://joss.theoj.org/papers/10.21105/joss.00565/status.svg" /></a>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#welcome-to-chempy-s-documentation" id="id3">Welcome to chempy’s documentation!</a></li>
<li><a class="reference internal" href="#indices-and-tables" id="id4">Indices and tables</a></li>
<li><a class="reference internal" href="#overview" id="id5">Overview</a><ul>
<li><a class="reference internal" href="#about-chempy" id="id6">About ChemPy</a></li>
<li><a class="reference internal" href="#documentation" id="id7">Documentation</a></li>
<li><a class="reference internal" href="#installation" id="id8">Installation</a><ul>
<li><a class="reference internal" href="#optional-dependencies" id="id9">Optional dependencies</a></li>
<li><a class="reference internal" href="#using-docker" id="id10">Using Docker</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id11">Examples</a><ul>
<li><a class="reference internal" href="#parsing-formulae" id="id12">Parsing formulae</a></li>
<li><a class="reference internal" href="#balancing-stoichiometry-of-a-chemical-reaction" id="id13">Balancing stoichiometry of a chemical reaction</a></li>
<li><a class="reference internal" href="#balancing-reactions" id="id14">Balancing reactions</a></li>
<li><a class="reference internal" href="#working-with-units" id="id15">Working with units</a></li>
<li><a class="reference internal" href="#chemical-equilibria" id="id16">Chemical equilibria</a></li>
<li><a class="reference internal" href="#concepts" id="id17">Concepts</a></li>
<li><a class="reference internal" href="#chemical-kinetics-system-of-ordinary-differential-equations" id="id18">Chemical kinetics (system of ordinary differential equations)</a></li>
<li><a class="reference internal" href="#properties" id="id19">Properties</a></li>
<li><a class="reference internal" href="#run-notebooks-using-binder" id="id20">Run notebooks using binder</a></li>
</ul>
</li>
<li><a class="reference internal" href="#citing" id="id21">Citing</a></li>
<li><a class="reference internal" href="#licensing" id="id22">Licensing</a></li>
<li><a class="reference internal" href="#see-also" id="id23">See also</a></li>
<li><a class="reference internal" href="#contributing" id="id24">Contributing</a></li>
<li><a class="reference internal" href="#author" id="id25">Author</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="about-chempy">
<h2><a class="toc-backref" href="#id6">About ChemPy</a><a class="headerlink" href="#about-chempy" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/bjodah/chempy">ChemPy</a> is a <a class="reference external" href="https://www.python.org">Python</a> package useful for
chemistry (mainly physical/inorganic/analytical chemistry). Currently it includes:</p>
<ul class="simple">
<li>Numerical integration routines for chemical kinetics (ODE solver front-end)</li>
<li>Integrated rate expressions (and convenience fitting routines)</li>
<li>Solver for equilibria (including multiphase systems)</li>
<li>Relations in physical chemistry:<ul>
<li>Debye-Hückel expressions</li>
<li>Arrhenius &amp; Eyring equation</li>
<li>Einstein-Smoluchowski equation</li>
</ul>
</li>
<li>Properties (pure python implementations from the litterature)<ul>
<li>water density as function of temperature</li>
<li>water permittivity as function of temperature and pressure</li>
<li>water diffusivity as function of temperature</li>
<li>water viscosity as function of temperature</li>
<li>sulfuric acid density as function of temperature &amp; weight fraction H₂SO₄</li>
<li>More to come… (and contributions are most welcome!)</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="documentation">
<h2><a class="toc-backref" href="#id7">Documentation</a><a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to get started is to have a look at the examples in this README,
and also the jupyter <a class="reference external" href="http://hera.physchem.kth.se/~chempy/branches/master/examples">notebooks</a>. In addition there is auto-generated API documentation
for the latest <a class="reference external" href="https://bjodah.github.io/chempy/latest">stable release here</a>
(and <a class="reference external" href="http://hera.physchem.kth.se/~chempy/branches/master/html">here are</a> the API docs for the development version).</p>
</div>
<div class="section" id="installation">
<h2><a class="toc-backref" href="#id8">Installation</a><a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Simplest way to install ChemPy and its (optional) dependencies is to use the
<a class="reference external" href="https://conda.pydata.org/docs/">conda package manager</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda install -c bjodah chempy pytest
$ pytest -rs -W ignore::chempy.ChemPyDeprecationWarning --pyargs chempy
</pre></div>
</div>
<p>currently conda packages are only provided for Linux. On Windows and OS X
you will need to use <code class="docutils literal notranslate"><span class="pre">pip</span></code> instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3 -m pip install chempy pytest
$ python3 -m pytest -rs -W ignore::chempy.ChemPyDeprecationWarning --pyargs chempy
</pre></div>
</div>
<p>there will a few tests which will be skipped due to some missing optional
backends in addition to those in SciPy (used for solving systems of non-linear
equations and ordinary differential equations).</p>
<div class="section" id="optional-dependencies">
<h3><a class="toc-backref" href="#id9">Optional dependencies</a><a class="headerlink" href="#optional-dependencies" title="Permalink to this headline">¶</a></h3>
<p>If you used <code class="docutils literal notranslate"><span class="pre">conda</span></code> to install ChemPy you can skip this section.
But if you use <code class="docutils literal notranslate"><span class="pre">pip</span></code> the default installation is achieved by writing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python -m pip install --user --upgrade chempy pytest
$ python -m pytest -rs --pyargs chempy
</pre></div>
</div>
<p>you can skip the <code class="docutils literal notranslate"><span class="pre">--user</span></code> flag if you have got root permissions.
You may be interested in using additional backends (in addition to those provided by SciPy)
for solving ODE-systems and non-linear optimization problems:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install chempy[all]
</pre></div>
</div>
<p>Note that this option will install the following libraries
(some of which require additional libraries to be present on your system):</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/bjodah/pygslodeiv2">pygslodeiv2</a>: solving initial value problems, requires <a class="reference external" href="https://www.gnu.org/software/gsl/">GSL</a>. (&gt;=1.16).</li>
<li><a class="reference external" href="https://github.com/bjodah/pyodeint">pyodeint</a>: solving initial value problems, requires <a class="reference external" href="http://www.boost.org/">boost</a> (&gt;=1.65.0).</li>
<li><a class="reference external" href="https://github.com/bjodah/pycvodes">pycvodes</a>: solving initial value problems, requires <a class="reference external" href="https://computation.llnl.gov/projects/sundials">SUNDIALS</a> (&gt;=2.7.0).</li>
<li><a class="reference external" href="https://github.com/bjodah/pykinsol">pykinsol</a>: solving non-linear root-finding, requires <a class="reference external" href="https://computation.llnl.gov/projects/sundials">SUNDIALS</a> (&gt;=2.7.0).</li>
<li><a class="reference external" href="https://github.com/bjodah/pycompilation">pycompilation</a>: python front-end for calling compilers, requires gcc/clang/icpc.</li>
<li><a class="reference external" href="https://github.com/bjodah/pycodeexport">pycodeexport</a>: package for code-generation, used when generating C++ code.</li>
</ul>
<p>if you want to see what packages need to be installed on a Debian based system you may look at this
<a class="reference external" href="scripts/environment/Dockerfile">Dockerfile</a>.</p>
</div>
<div class="section" id="using-docker">
<h3><a class="toc-backref" href="#id10">Using Docker</a><a class="headerlink" href="#using-docker" title="Permalink to this headline">¶</a></h3>
<p>If you have <a class="reference external" href="https://www.docker.com">Docker</a> installed, you may use it to host a jupyter
notebook server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./scripts/host-jupyter-using-docker.sh . 8888
</pre></div>
</div>
<p>the first time you run the command, some dependencies will be downloaded. When the installation
is complete there will be a link visible which you can open in your browser. You can also run
the test suite using the same docker-image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./scripts/host-jupyter-using-docker.sh . 0
</pre></div>
</div>
<p>there will be a few skipped test (due to some dependencies not being installed by default) and
quite a few warnings.</p>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id11">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>See demonstration scripts in <a class="reference external" href="https://github.com/bjodah/chempy/tree/master/examples">examples/</a>,
and some rendered jupyter <a class="reference external" href="http://hera.physchem.kth.se/~chempy/branches/master/examples">notebooks</a>.
You may also browse the documentation for more examples. Below you will find a few code snippets:</p>
<div class="section" id="parsing-formulae">
<h3><a class="toc-backref" href="#id12">Parsing formulae</a><a class="headerlink" href="#parsing-formulae" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">Substance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ferricyanide</span> <span class="o">=</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;Fe(CN)6-3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ferricyanide</span><span class="o">.</span><span class="n">composition</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">26</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>  <span class="c1"># 0 for charge</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ferricyanide</span><span class="o">.</span><span class="n">unicode_name</span><span class="p">)</span>
<span class="go">Fe(CN)₆³⁻</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ferricyanide</span><span class="o">.</span><span class="n">latex_name</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">ferricyanide</span><span class="o">.</span><span class="n">html_name</span><span class="p">)</span>
<span class="go">Fe(CN)_{6}^{3-}, Fe(CN)&lt;sub&gt;6&lt;/sub&gt;&lt;sup&gt;3-&lt;/sup&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ferricyanide</span><span class="o">.</span><span class="n">mass</span><span class="p">)</span>
<span class="go">211.955</span>
</pre></div>
</div>
<p>as you see, in composition, the atomic numbers (and 0 for charge) is used as
keys and the count of each kind became respective value.</p>
</div>
<div class="section" id="balancing-stoichiometry-of-a-chemical-reaction">
<h3><a class="toc-backref" href="#id13">Balancing stoichiometry of a chemical reaction</a><a class="headerlink" href="#balancing-stoichiometry-of-a-chemical-reaction" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">balance_stoichiometry</span>  <span class="c1"># Main reaction in NASA&#39;s booster rockets:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reac</span><span class="p">,</span> <span class="n">prod</span> <span class="o">=</span> <span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;NH4ClO4&#39;</span><span class="p">,</span> <span class="s1">&#39;Al&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;Al2O3&#39;</span><span class="p">,</span> <span class="s1">&#39;HCl&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">reac</span><span class="p">))</span>
<span class="go">{&#39;Al&#39;: 10, &#39;NH4ClO4&#39;: 6}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">prod</span><span class="p">))</span>
<span class="go">{&#39;Al2O3&#39;: 5, &#39;H2O&#39;: 9, &#39;HCl&#39;: 6, &#39;N2&#39;: 3}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">mass_fractions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">fractions</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="n">mass_fractions</span><span class="p">,</span> <span class="p">[</span><span class="n">reac</span><span class="p">,</span> <span class="n">prod</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="n">pprint</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{0:.3g}</span><span class="s1"> wt%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">fractions</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<span class="gp">...</span>
<span class="go">{&#39;Al&#39;: &#39;27.7 wt%&#39;, &#39;NH4ClO4&#39;: &#39;72.3 wt%&#39;}</span>
<span class="go">{&#39;Al2O3&#39;: &#39;52.3 wt%&#39;, &#39;H2O&#39;: &#39;16.6 wt%&#39;, &#39;HCl&#39;: &#39;22.4 wt%&#39;, &#39;N2&#39;: &#39;8.62 wt%&#39;}</span>
</pre></div>
</div>
<p>ChemPy can also balance reactions where the reacting species are more complex and
are better described in other terms than their molecular formula. A silly, yet
illustrative example would be how to make pancakes without any partially used packages:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">substances</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">Substance</span><span class="p">(</span><span class="s1">&#39;pancake&#39;</span><span class="p">,</span> <span class="n">composition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eggs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">spoons_of_flour</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cups_of_milk</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">Substance</span><span class="p">(</span><span class="s1">&#39;eggs_6pack&#39;</span><span class="p">,</span> <span class="n">composition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">eggs</span><span class="o">=</span><span class="mi">6</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">Substance</span><span class="p">(</span><span class="s1">&#39;milk_carton&#39;</span><span class="p">,</span> <span class="n">composition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">cups_of_milk</span><span class="o">=</span><span class="mi">4</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">Substance</span><span class="p">(</span><span class="s1">&#39;flour_bag&#39;</span><span class="p">,</span> <span class="n">composition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">spoons_of_flour</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>
<span class="gp">... </span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;eggs_6pack&#39;</span><span class="p">,</span> <span class="s1">&#39;milk_carton&#39;</span><span class="p">,</span> <span class="s1">&#39;flour_bag&#39;</span><span class="p">},</span>
<span class="gp">... </span>                                               <span class="p">{</span><span class="s1">&#39;pancake&#39;</span><span class="p">},</span> <span class="n">substances</span><span class="o">=</span><span class="n">substances</span><span class="p">)])</span>
<span class="go">[{&#39;eggs_6pack&#39;: 10, &#39;flour_bag&#39;: 2, &#39;milk_carton&#39;: 15}, {&#39;pancake&#39;: 60}]</span>
</pre></div>
</div>
<p>ChemPy can even handle reactions with linear dependencies (underdetermined systems), e.g.:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;CO2&#39;</span><span class="p">,</span> <span class="s1">&#39;CO&#39;</span><span class="p">})])</span>  
<span class="go">[{&#39;C&#39;: x1 + 2, &#39;O2&#39;: x1 + 1}, {&#39;CO&#39;: 2, &#39;CO2&#39;: x1}]</span>
</pre></div>
</div>
<p>the <code class="docutils literal notranslate"><span class="pre">x1</span></code> object above is an instance of SymPy’s <a class="reference external" href="http://docs.sympy.org/latest/modules/core.html#sympy.core.symbol.Symbol">Symbol</a>. If we prefer to get a solution
with minimal (non-zero) integer coefficients we can pass <code class="docutils literal notranslate"><span class="pre">underdetermined=None</span></code>:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;CO2&#39;</span><span class="p">,</span> <span class="s1">&#39;CO&#39;</span><span class="p">},</span> <span class="n">underdetermined</span><span class="o">=</span><span class="kc">None</span><span class="p">)])</span>
<span class="go">[{&#39;C&#39;: 3, &#39;O2&#39;: 2}, {&#39;CO&#39;: 2, &#39;CO2&#39;: 1}]</span>
</pre></div>
</div>
<p>note however that even though this solution is in some sense “canonical”,
it is merely one of an inifite number of solutions (<code class="docutils literal notranslate"><span class="pre">x1</span></code> from earlier may be any integer).</p>
</div>
<div class="section" id="balancing-reactions">
<h3><a class="toc-backref" href="#id14">Balancing reactions</a><a class="headerlink" href="#balancing-reactions" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">Equilibrium</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K1</span><span class="p">,</span> <span class="n">K2</span><span class="p">,</span> <span class="n">Kw</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;K1 K2 Kw&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;MnO4-&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;e-&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;Mn+2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">K1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e2</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;e-&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;OH-&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">K2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeff</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="o">.</span><span class="n">eliminate</span><span class="p">([</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">],</span> <span class="s1">&#39;e-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeff</span>
<span class="go">[4, -5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">redox</span> <span class="o">=</span> <span class="n">e1</span><span class="o">*</span><span class="n">coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">e2</span><span class="o">*</span><span class="n">coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">redox</span><span class="p">)</span>
<span class="go">32 H+ + 4 MnO4- + 20 OH- = 26 H2O + 4 Mn+2 + 5 O2; K1**4/K2**5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autoprot</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;OH-&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">Kw</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">redox</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="n">autoprot</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span>
<span class="go">20</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">redox2</span> <span class="o">=</span> <span class="n">redox</span> <span class="o">+</span> <span class="n">n</span><span class="o">*</span><span class="n">autoprot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">redox2</span><span class="p">)</span>
<span class="go">12 H+ + 4 MnO4- = 6 H2O + 4 Mn+2 + 5 O2; K1**4*Kw**20/K2**5</span>
</pre></div>
</div>
</div>
<div class="section" id="working-with-units">
<h3><a class="toc-backref" href="#id15">Working with units</a><a class="headerlink" href="#working-with-units" title="Permalink to this headline">¶</a></h3>
<p>Functions and objects useful
for working with units are available from the <code class="docutils literal notranslate"><span class="pre">chempy.units</span></code> module. Here is an
example of how ChemPy can check consistency of units:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">Reaction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H2O -&gt; H+ + OH-; 1e-4/M/s&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Check failed: &#39;consistent_units&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H2O -&gt; H+ + OH-; 1e-4/s&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.units</span> <span class="k">import</span> <span class="n">to_unitless</span><span class="p">,</span> <span class="n">default_units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_unitless</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span>
<span class="go">0.006</span>
</pre></div>
</div>
<p>right now the <code class="docutils literal notranslate"><span class="pre">.units</span></code> module wraps the <a class="reference external" href="http://python-quantities.readthedocs.io/en/latest/">quantities</a> package with some minor
additions and work-arounds. However, there is no guarantee that the underlying
package will not change in a future version of ChemPy (there are many packages
for dealing with units in the scientific Python ecosystem).</p>
</div>
<div class="section" id="chemical-equilibria">
<h3><a class="toc-backref" href="#id16">Chemical equilibria</a><a class="headerlink" href="#chemical-equilibria" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">Equilibrium</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.chemistry</span> <span class="k">import</span> <span class="n">Species</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">water_autop</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;H2O&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;H+&#39;</span><span class="p">,</span> <span class="s1">&#39;OH-&#39;</span><span class="p">},</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># unit &quot;molar&quot; assumed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ammonia_prot</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;NH4+&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;NH3&#39;</span><span class="p">,</span> <span class="s1">&#39;H+&#39;</span><span class="p">},</span> <span class="mi">10</span><span class="o">**-</span><span class="mf">9.24</span><span class="p">)</span>  <span class="c1"># same here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.equilibria</span> <span class="k">import</span> <span class="n">EqSystem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">substances</span> <span class="o">=</span> <span class="p">[</span><span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="s1">&#39;H2O OH- H+ NH3 NH4+&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eqsys</span> <span class="o">=</span> <span class="n">EqSystem</span><span class="p">([</span><span class="n">water_autop</span><span class="p">,</span> <span class="n">ammonia_prot</span><span class="p">],</span> <span class="n">substances</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">eqsys</span><span class="o">.</span><span class="n">rxns</span><span class="p">)))</span>  <span class="c1"># &quot;rxns&quot; short for &quot;reactions&quot;</span>
<span class="go">H2O = H+ + OH-; 1e-14</span>
<span class="go">NH4+ = H+ + NH3; 5.75e-10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_conc</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;NH3&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="n">sane</span> <span class="o">=</span> <span class="n">eqsys</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">init_conc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">sol</span><span class="p">[</span><span class="s1">&#39;success&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">sane</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="p">))</span>
<span class="go">1, 0.0013, 7.6e-12, 0.099, 0.0013</span>
</pre></div>
</div>
</div>
<div class="section" id="concepts">
<h3><a class="toc-backref" href="#id17">Concepts</a><a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h3>
<p>ChemPy collects equations and utility functions for working with
concepts such as <a class="reference external" href="https://en.wikipedia.org/wiki/Ionic_strength">ionic strength</a>:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.electrolytes</span> <span class="k">import</span> <span class="n">ionic_strength</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ionic_strength</span><span class="p">({</span><span class="s1">&#39;Fe+3&#39;</span><span class="p">:</span> <span class="mf">0.050</span><span class="p">,</span> <span class="s1">&#39;ClO4-&#39;</span><span class="p">:</span> <span class="mf">0.150</span><span class="p">})</span> <span class="o">==</span> <span class="o">.</span><span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
<p>note how ChemPy parsed the charges from the names of the substances. There are
also e.g. empirical equations and convenience classes for them available, e.g.:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.henry</span> <span class="k">import</span> <span class="n">Henry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kH_O2</span> <span class="o">=</span> <span class="n">Henry</span><span class="p">(</span><span class="mf">1.2e-3</span><span class="p">,</span> <span class="mi">1800</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;carpenter_1966&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">kH_O2</span><span class="p">(</span><span class="mf">298.15</span><span class="p">))</span>
<span class="go">1.2e-03</span>
</pre></div>
</div>
<p>to get more information about e.g. this class, you may can look at the API
<a class="reference external" href="https://bjodah.github.io/chempy/latest/chempy.html#module-chempy.henry">documentation</a> .</p>
</div>
<div class="section" id="chemical-kinetics-system-of-ordinary-differential-equations">
<h3><a class="toc-backref" href="#id18">Chemical kinetics (system of ordinary differential equations)</a><a class="headerlink" href="#chemical-kinetics-system-of-ordinary-differential-equations" title="Permalink to this headline">¶</a></h3>
<p>A common task when modelling problems in chemistry is to investigate the time dependence
of a system. This branch of study is known as
<a class="reference external" href="https://en.wikipedia.org/wiki/Chemical_kinetics">chemical kinetics</a>, and ChemPy has
some classes and functions for working with such problems:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">ReactionSystem</span>  <span class="c1"># The rate constants below are arbitrary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsys</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;2 Fe+2 + H2O2 -&gt; 2 Fe+3 + 2 OH-; 42</span>
<span class="gp">... </span><span class="s2">    2 Fe+3 + H2O2 -&gt; 2 Fe+2 + O2 + 2 H+; 17</span>
<span class="gp">... </span><span class="s2">    H+ + OH- -&gt; H2O; 1e10</span>
<span class="gp">... </span><span class="s2">    H2O -&gt; H+ + OH-; 1e-4&quot;&quot;&quot;</span><span class="p">)</span>  <span class="c1"># &quot;[H2O]&quot; = 1.0 (actually 55.4 at RT)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.kinetics.ode</span> <span class="k">import</span> <span class="n">get_odesys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">odesys</span><span class="p">,</span> <span class="n">extra</span> <span class="o">=</span> <span class="n">get_odesys</span><span class="p">(</span><span class="n">rsys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tout</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Fe+2&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;H2O2&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="s1">&#39;OH-&#39;</span><span class="p">:</span> <span class="mf">1e-12</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">odesys</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">tout</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rsys</span><span class="o">.</span><span class="n">substances</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;H2O&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mf">1e-13</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;examples/kinetics.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/bjodah/chempy/master/examples/kinetics.png" src="https://raw.githubusercontent.com/bjodah/chempy/master/examples/kinetics.png" />
</div>
<div class="section" id="properties">
<h3><a class="toc-backref" href="#id19">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h3>
<p>One of the fundamental tasks in science is the careful collection of data about the world
around us. ChemPy contains a growing collection of parametrizations from the scientific
litterature with relevance in chemistry. Here is how you use one of these formulations:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">Substance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.properties.water_density_tanaka_2001</span> <span class="k">import</span> <span class="n">water_density</span> <span class="k">as</span> <span class="n">rho</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.units</span> <span class="k">import</span> <span class="n">to_unitless</span><span class="p">,</span> <span class="n">default_units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">water</span> <span class="o">=</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;H2O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">T_C</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">concentration_H2O</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="p">(</span><span class="mf">273.15</span> <span class="o">+</span> <span class="n">T_C</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kelvin</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="n">water</span><span class="o">.</span><span class="n">molar_mass</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[H2O] = </span><span class="si">%.2f</span><span class="s1"> M (at </span><span class="si">%d</span><span class="s1"> °C)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">to_unitless</span><span class="p">(</span><span class="n">concentration_H2O</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">molar</span><span class="p">),</span> <span class="n">T_C</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">[H2O] = 55.46 M (at 15 °C)</span>
<span class="go">[H2O] = 55.35 M (at 25 °C)</span>
<span class="go">[H2O] = 55.18 M (at 35 °C)</span>
</pre></div>
</div>
</div>
<div class="section" id="run-notebooks-using-binder">
<h3><a class="toc-backref" href="#id20">Run notebooks using binder</a><a class="headerlink" href="#run-notebooks-using-binder" title="Permalink to this headline">¶</a></h3>
<p>Using only a web-browser (and an internet connection) it is possible to explore the
notebooks here: (by the courtesy of the people behind mybinder)</p>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/bjodah/chempy/v0.6.6?filepath=index.ipynb"><img alt="Binder" src="http://mybinder.org/badge.svg" /></a>
</div>
</div>
<div class="section" id="citing">
<h2><a class="toc-backref" href="#id21">Citing</a><a class="headerlink" href="#citing" title="Permalink to this headline">¶</a></h2>
<p>If you make use of ChemPy in e.g. academic work you may cite the following peer-reviewed publication:</p>
<a class="reference external image-reference" href="https://doi.org/10.21105/joss.00565"><img alt="Journal of Open Source Software DOI" src="http://joss.theoj.org/papers/10.21105/joss.00565/status.svg" /></a>
<p>Depending on what underlying solver you are using you should also cite the appropriate paper
(you can look at the list of references in the JOSS article). If you need to reference,
in addition to the paper, a specific point version of ChemPy (for e.g. reproducibility)
you can get per-version DOIs from the zendodo archive:</p>
<a class="reference external image-reference" href="https://zenodo.org/badge/latestdoi/8840/bjodah/chempy"><img alt="Zenodo DOI" src="https://zenodo.org/badge/8840/bjodah/chempy.svg" /></a>
</div>
<div class="section" id="licensing">
<h2><a class="toc-backref" href="#id22">Licensing</a><a class="headerlink" href="#licensing" title="Permalink to this headline">¶</a></h2>
<p>The source code is Open Source and is released under the very permissive
<a class="reference external" href="https://opensource.org/licenses/BSD-2-Clause">“simplified (2-clause) BSD license”</a>.
See <a class="reference external" href="LICENSE">LICENSE</a> for further details.</p>
</div>
<div class="section" id="see-also">
<h2><a class="toc-backref" href="#id23">See also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://github.com/sympy/sympy">SymPy</a></li>
<li><a class="reference external" href="https://github.com/bjodah/pyneqsys">pyneqsys</a></li>
<li><a class="reference external" href="https://github.com/bjodah/pyodesys">pyodesys</a></li>
<li><a class="reference external" href="https://github.com/CalebBell/thermo">thermo</a></li>
</ul>
</div>
<div class="section" id="contributing">
<h2><a class="toc-backref" href="#id24">Contributing</a><a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Contributors are welcome to suggest improvements at <a class="reference external" href="https://github.com/bjodah/chempy">https://github.com/bjodah/chempy</a>
(see further details <a class="reference external" href="CONTRIBUTING.rst">here</a>).</p>
</div>
<div class="section" id="author">
<h2><a class="toc-backref" href="#id25">Author</a><a class="headerlink" href="#author" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Björn I. Dahlgren, contact:</dt>
<dd><ul class="first last simple">
<li>gmail address: bjodah</li>
<li>kth.se address: bda</li>
</ul>
</dd>
</dl>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chempy.html" class="btn btn-neutral float-right" title="chempy package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Bjoern I. Dahlgren &lt;bjodah@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.6.14',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>